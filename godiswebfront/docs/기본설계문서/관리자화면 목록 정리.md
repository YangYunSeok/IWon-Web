
# 관리자 웹 화면 / 기능 / API / DB 정리

---

## 0. 전체 관리자 업무 흐름 요약 (Overview)

```text
월별 지급 대상자 관리
 → 코인 지급 관리 (지급 요청 생성)
 → 승인 관리 (온체인 반영 여부 결정)
 → 거래 이력 조회 (결과 확인)
 → 대시보드 (집계/모니터링)
```

* 모든 코인 이동은 **요청 → 승인 → 체인 반영 → 이력 기록** 순서
* 관리자는 직접 체인을 조작하지 않으며, **승인 관리 화면이 최종 통제 지점**

## 0.1. 권한 정책 (Segregation of Duties)

본 관리자 시스템은 작성자(요청 생성)와 승인자(최종 결정)를 분리

- 작성자(ROLE_ADMIN_OPERATOR): 요청 생성/관리 업무 수행
- 승인자(ROLE_ADMIN_APPROVER): 승인/반려 및 감사 확인 업무 수행
- 공통(ROLE_ADMIN_VIEWER): 조회 전용 화면 접근

권한 룰
- 승인자는 요청 생성 화면(지갑관리/지급관리/월별대상자)을 접근하지 않는다.
- 작성자는 승인 처리 기능을 수행할 수 없다.
- 작성자와 승인자는 동일 계정/동일 역할로 겸임하지 않는다(SoD).

화면별 접근
- 승인자: 1. 대시보드, 4. 거래이력조회, 5. 승인관리
- 작성자: 전체 화면 (승인 관리 화면은 조회만)

---

## 1. 대시보드 (Dashboard)

* 파일명: `STOCOIN01S1.jsx`
* 화면 성격: **모니터링 / 집계 (조회 전용)**

### 1.1 목적

* 전체 코인 발행량, 유통량, 잔액을 한눈에 파악
* 이상 징후 발생 시 상세 화면으로 빠른 이동

### 1.2 주요 기능

* 전체 발행 / 유통 / 잔액 요약
* 일별 지급/회수 지표
* 시스템 상태 및 Alert 표시

### 1.3 연계 API

* `GET /admin/stats/supply` (webDashboard.getSupply)
* `GET /admin/stats/daily` (webDashboard.getDaily)

### 1.4 주요 DB 테이블

* `wallets`
* `wallet_transactions`
* `coin_types`
* `approvals`

### 1.5 권한

* 접근 권한: `ROLE_ADMIN_VIEWER`
* 대상 역할:
  - 작성자(ROLE_ADMIN_OPERATOR)
  - 승인자(ROLE_ADMIN_APPROVER)
* 비고:
  - 조회 전용 화면
  - 모든 관리자 공통 모니터링 목적

---

## 2. 임직원 지갑 관리 (Wallet Management)

* 파일명: `STOCOIN02S1.jsx`
* 화면 성격: **조회 / 기본 관리**

### 2.1 목적

* 임직원 지갑 상태를 조회하고 관리
* 신규 지갑 생성 및 기본 상태 확인

### 2.2 주요 기능

* 임직원 목록 조회 및 검색
* 지갑 생성
* 지갑 상태 확인
* 블록체인 Explorer 링크 제공
* KPI 요약 정보 표시

### 2.3 연계 API

* `GET /admin/employees` (webWallet.listEmployees)
* `POST /admin/wallets/create` (webWallet.create)

### 2.4 주요 DB 테이블

* `employees`
* `wallets`

### 2.5 권한

* 접근 권한: `ROLE_ADMIN_OPERATOR`
* 대상 역할:
  - 작성자(요청 생성자)
* 비고:
  - 승인자는 접근 불가
  - 요청 생성 및 운영 업무 전용 화면


---

## 3. 코인 지급 관리 (Coin Distribution)

* 파일명: `STOCOIN03S1.jsx`
* 화면 성격: **요청 생성 (실행 전 단계)**

### 3.1 목적

* 코인 지급(Mint) / 회수(Burn) 요청을 생성
* 실제 체인 반영은 승인 관리 화면에서 결정

### 3.2 주요 기능

* 개별 지급/회수 요청
* 일괄 업로드(Bulk)
* 요청 내역 조회

### 3.3 연계 API

* `POST /admin/mint/request` (webMint.request)
* `POST /admin/burn/request` (webBurn.request)

### 3.4 주요 DB 테이블

* `wallet_transactions`
* `approvals`
* `approval_targets`

### 3.5 권한

* 접근 권한: `ROLE_ADMIN_OPERATOR`
* 대상 역할:
  - 작성자(요청 생성자)
* 비고:
  - 지급/회수 요청 생성 화면
  - 승인자는 접근 불가
  - 실제 체인 반영은 승인 관리 화면에서만 수행


---

## 4. 거래 이력 조회 (Transaction History)

* 파일명: `STOCOIN04S1.jsx`
* 화면 성격: **감사 / 추적 (조회 전용)**

### 4.1 목적

* 모든 코인 이동 내역을 추적
* 관리자/감사 대응을 위한 근거 제공

### 4.2 주요 기능

* 거래 내역 검색
* TxHash / 유형 / 금액 / 상태 표시
* 승인 정보 연계 표시

### 4.3 연계 API

* `(TBD) GET /admin/transactions`

> ⚠️ 결정 필요
>
> * 기존 `/wallet/transactions` 재사용 + 관리자 필터
> * 또는 `/admin/transactions` 전용 API 신설

### 4.4 주요 DB 테이블

* `wallet_transactions`
* `employees`
* `coin_types`

### 4.5 권한

* 접근 권한: `ROLE_ADMIN_VIEWER`
* 대상 역할:
  - 작성자(ROLE_ADMIN_OPERATOR)
  - 승인자(ROLE_ADMIN_APPROVER)
* 비고:
  - 감사 및 추적 목적의 조회 전용 화면
  - 승인자는 승인 판단 근거 확인 용도로 사용


---

## 5. 승인 관리 (Onchain Approval Management)

* 파일명: `STOCOIN05S1.jsx`
* 화면 성격: **최종 결정 / 통제**

### 5.1 목적

* 코인 지급/회수 요청에 대한 최종 승인
* 온체인 반영 여부를 결정하는 핵심 화면

### 5.2 주요 기능

* 승인 대기 목록 조회
* 승인 / 반려 처리
* 상태 및 이력 관리

### 5.3 연계 API

* `GET /admin/approvals/pending` (webApproval.listPending)
* `POST /admin/approvals/{approvalId}/confirm` (webApproval.confirm)

### 5.4 주요 DB 테이블

* `approvals`
* `approval_targets`
* `admin_users`

### 5.5 권한

* 접근 권한:
  - 승인 처리: `ROLE_ADMIN_APPROVER`
  - 조회 전용: `ROLE_ADMIN_OPERATOR`
* 대상 역할:
  - 승인자: 승인 / 반려 처리 가능
  - 작성자: 조회만 가능 (승인/반려 불가)
* 비고:
  - 작성자 본인의 요청은 승인 불가 (서버 단에서 강제)
  - 최종 온체인 반영 여부를 결정하는 통제 화면


---

## 6. 월별 지급 대상자 관리 (Monthly Payment Planning)

* 파일명: `STOCOIN06S1.jsx`
* 화면 성격: **사전 계획 관리**

### 6.1 목적

* 월 단위 지급 대상자 사전 관리
* 반복 지급 업무 자동화 기반 제공

### 6.2 주요 기능

* 월별 대상자 등록 / 수정 / 삭제
* 지급 계획 확정
* 전월 데이터 복사

### 6.3 연계 API

* `GET /admin/monthly-payees` (webMonthlyPayee.list)
* `POST /admin/monthly-payees` (webMonthlyPayee.createBulk)
* `PUT /admin/monthly-payees/{id}`
* `DELETE /admin/monthly-payees/{id}`

### 6.4 주요 DB 테이블

* `monthly_payees`
* `employees`
* `approvals`

### 6.5 권한

* 접근 권한: `ROLE_ADMIN_OPERATOR`
* 대상 역할:
  - 작성자(요청 생성자)
* 비고:
  - 지급 사전 계획 및 운영 전용 화면
  - 승인자는 접근 불가


---

## A. 공통 상태(Status) 코드 정의

### A.1 Approval 상태

| 값                | 의미       |
| ---------------- | -------- |
| `PENDING`        | 승인 대기    |
| `APPROVED`       | 승인 완료    |
| `REJECTED`       | 반려       |
| `ONCHAIN_FAILED` | 체인 반영 실패 |

### A.2 Transaction 상태

| 값           | 의미       |
| ----------- | -------- |
| `REQUESTED` | 요청 생성    |
| `CONFIRMED` | 체인 반영 완료 |
| `FAILED`    | 처리 실패    |

---

## B. 예외 / 운영 정책

| 상황        | 처리 방식               |
| --------- | ------------------- |
| 잔액 부족 | 요청 단계에서 차단          |
| 체인 오류     | FAILED 상태 저장        |
| 승인 중복 요청  | 서버에서 idempotency 처리 |
| 감사 대응     | 관리자 + 승인 이력 기준 추적   |

---

## C. 결정 필요 사항 (TBD)

* 거래 이력 조회 API 설계 방향
* 관리자 권한 세분화 범위
* 대시보드 Alert 기준값 정의

---


